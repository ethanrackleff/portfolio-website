<!doctype html>
<html lang="US">
    <head>
        <meta charset="utf-8" />

        <title>Ethan Rackleff Portfolio</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" /> 
        <style>
            /*Default Colors & Color palettes*/
            :root{
                --bg: #fff;
                --text: #000;
                --accent: #ccc;
                --prompt: #000;
                --cursor: #000;
                --shadow: #000;
            }
            body[theme="matrix"] {
                --bg: #000;
                --text: #b7ffb7;
                --muted: #7ccc7c;
                --accent: #22ff88;
                --prompt: #00ff99;
                --cursor: #b7ffb7;
            }
            /* Page */
            * {
                font-size: 15px;
                font-family: monospace, sans-serif;
                font-weight: normal;
            }
            html, body {
                height: 100%;
                margin: 0px;
            }
            body {
                background: var(--bg) fixed;
                color: var(--text); 
                display: grid;
                place-items: center;
            }
            .term {
                width: min(600px, 92vw);
                height: min(600px, 80vh);
                background-color: var(--bg);
                border: 2px solid var(--accent);
                padding: 1em;
                filter: drop-shadow(5px 5px var(--accent));
                display: grid;
                overflow-y: auto;
                word-break: normal;
                overflow-wrap: anywhere;
                scrollbar-width: none;
                align-content: start;
            }
            .line {
                width: 100%;
                display: flex;
            }
            .line > * {
                padding-right: 1em;
            }
            .cmdPrompt {
               flex-shrink: 0;
            }
            .line input {
                flex: 1;
                border: none;
                outline: none;
            }
            input:disabled {
                color: inherit;
                font-size: inherit;
            }
            
        </style>
    </head>
    <body>
        <div class="term" id="term">

        </div>
        <script>
            const COMMANDS = ["about", "help", "clear", "switch-colors"];
            const term = document.getElementById("term");

            const bootMessage = ["Welcome to my portfolio", 
                "My name is Ethan Rackleff", 
                "type help"]

            //Prints to terminal. 
            //Takes a string of arrays
            //if end=true, string is printed at the bottom of the terminal
            //if end=false, string is printed at the top
            function print(arr, end=true) {
                for (const l of arr) {
                    const cmdPrompt = document.createElement("div");
                    cmdPrompt.className = "cmdPrompt";
                    cmdPrompt.textContent = "$";
                    const text = document.createElement("div");
                    text.className = "text";
                    text.textContent = l;
                    const line = document.createElement("div");
                    line.className = "line";
                    line.appendChild(cmdPrompt);
                    line.appendChild(text); 
                    if (end) {
                        term.appendChild(line);
                    }
                    else {
                        term.insertBefore(line, firstCmd);
                    }
                }
            }
            //Prints Introduction Message
            function boot(arr) { 
                print(arr);
               newInput(); 
            }
            
            function newInput(prev) {
                if (prev) {
                    prev.blur();
                    prev.disabled = true;
                    prev.removeEventListener("keydown", (event) => {
                    if (event.key === "Enter") {
                        runCommand(input.value);
                        }
                    }); 
                }
                
                const cmdPrompt = document.createElement("div");
                cmdPrompt.className = "cmdPrompt";
                cmdPrompt.textContent = "$";
                const cmd = document.createElement("input");
                cmd.className = "cmd";
                const line = document.createElement("div");
                line.className = "line";
                line.appendChild(cmdPrompt);
                line.appendChild(cmd); 
                term.appendChild(line);
                cmd.focus();
                cmd.addEventListener("keydown", (event) => {
                    if (event.key === "Enter") {
                        runCommand(cmd);
                    }
                });

            }

            function runCommand(cmd) {
                if (cmd.value.startsWith("help")) {
                    print(["Testing"]);
                }
                else if (cmd.value.startsWith("theme")) {
                    //theme(cmd);
                    print(["theme"]);
                }
                else {
                    //this case prints one char too much to the left
                    //FIX!
                    print([`${cmd.value} bad command`]);
                }
                
                newInput(cmd);
            }

            boot(bootMessage);
        </script>
        </body>
</html>
